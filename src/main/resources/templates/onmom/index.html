<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<th:block th:replace="~{/layout/basic :: setContent(~{this::content})}">
    <th:block th:fragment="content">
    <!-- Header-->
    <header class="bg-white py-5 back_img">
        <div class="container px-5" >
            <div class="row gx-5 align-items-center justify-content-center" style="background-color:rgba(0,0,0,0.5);">
                <div class="col-lg-8 col-xl-7 col-xxl-6">
                    <div class="my-5 text-center text-xl-start">
                        <p class="lead fw-normal fw-bolder text-info mb-2">고민하고 계신가요?</p>
                        <h1 class="fw-bolder text-white mb-4">온몸 회원들의 생생한 후기에서 최고의 헬스장을 찾아보세요 !</h1>
                        <hr style="background-color:white; margin:0; opacity:initial;" />
                        <div class="d-grid gap-3 d-sm-flex justify-content-sm-center justify-content-xl-start" style="margin-top:90px;">
                            <a class="btn btn-primary btn-lg px-4 me-sm-3" href="#loc_review">추천 헬스장</a>
                            <a class="btn btn-light btn-lg px-4" href="#loc_map">서울시 헬스장</a>
                        </div>
                    </div>
                </div>
<!--                <div class="col-xl-5 col-xxl-6 d-none d-xl-block text-center">-->
<!--&lt;!&ndash;                    <img class="img-fluid rounded-3 my-5" src="https://dummyimage.com/600x400/343a40/6c757d" alt="..." />&ndash;&gt;-->
<!--                </div>-->
            </div>
        </div>
    </header>

    <!--  메인 content(추천 헬스장, 카카오맵 ... 등)  -->
    <div class="container-fluid" style="margin-top:80px;">
        <div id="loc_review" class="px-lg-5">
            <div class="content_title">
                <div>
                    <img src="/img/star.png" alt="별">
                </div>
                <h1>추천 헬스장</h1>
                <p>온몸 회원들이 추천하는 헬스장입니다!</p>
                <select class="area_select" id="select_value" onchange="ChangeValue()">
                    <option value="전체">전체</option>
                    <option value="도봉구">도봉구</option>
                    <option value="노원구">노원구</option>
                    <option value="강북구">강북구</option>
                    <option value="성북구">성북구</option>
                    <option value="중랑구">중랑구</option>
                    <option value="동대문구">동대문구</option>
                    <option value="종로구">종로구</option>
                    <option value="서대문구">서대문구</option>
                    <option value="은평구">은평구</option>
                    <option value="마포구">마포구</option>
                    <option value="중구">중구</option>
                    <option value="용산구">용산구</option>
                    <option value="성동구">성동구</option>
                    <option value="광진구">광진구</option>
                    <option value="강서구">강서구</option>
                    <option value="양천구">양천구</option>
                    <option value="구로구">구로구</option>
                    <option value="영등포구">영등포구</option>
                    <option value="금천구">금천구</option>
                    <option value="동작구">동작구</option>
                    <option value="관악구">관악구</option>
                    <option value="서초구">서초구</option>
                    <option value="강남구">강남구</option>
                    <option value="송파구">송파구</option>
                    <option value="강동구">강동구</option>
                </select>
                <div class="btn_frame">
                    <a href="/onmom/review/list">MORE</a>
                </div>
            </div>
            <div class="row">
                <!-- Gallery item -->
                <div th:each="dto : ${result.dtoList}" class="col-xl-3 col-lg-4 col-md-6 mb-4 ">
                    <div class="bg-white rounded shadow-sm galBox_sizing">
                        <!-- 이미지 썸네일 -->
                        <img    th:if="${dto.imageDTOList.size() > 0 && dto.imageDTOList[0].path != null }"
                                th:src="|/display?fileName=${dto.imageDTOList[0].getThumbnailURL()}|" alt="" class="img-fluid card-img-top img_sizing">
                        <div class="p-4" style="position:relative;">
                            <span class="text-muted" style="position:absolute; left:10px; top:10px; font-size:12px;">
                                [[${dto.area}]]
                            </span>
                            <h5 style="padding-left:25px; width:360px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">
                                <a th:href="@{/onmom/review/read(review_id = ${dto.review_id}, page = ${result.page})}" class="text-dark">
                                    [[${dto.title}]]
                                </a>
                            </h5>
                            <!-- 글 내용 일부 미리보기 -->
                            <p id="content_view" class="small text-muted mb-0" style="width:250px; height:30px; font-size:12px;  overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">
                                <span class="tag_delete">[[${dto.content}]]</span>
                            </p>
                            <div class="d-flex align-items-center justify-content-between rounded-pill bg-light px-3 py-2 mt-4">
                                <p class="small mb-0">
                                    <!-- like 카운트 -->
                                    <span>
                                        <img src="/img/like.png" style="width:32px;" alt="좋아요">
                                        <span class="font-weight-bold">
                                            [[${dto.like_cnt}]]
                                        </span>
                                    </span>
                                    <!-- dislike 카운트 -->
                                    <span>
                                        <img src="/img/dislike.png" style="width:32px;" alt="싫어요">
                                        <span class="font-weight-bold">
                                            [[${dto.hate_cnt}]]
                                        </span>
                                    </span>
                                </p>
                                <!--    <div class="badge badge-danger px-3 rounded-pill font-weight-normal">New</div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Testimonial section-->
        <!-- 카카오맵 ----------------------------------------------->
        <div id="loc_map" class="content_title">
            <div>
                <img src="/img/marker.png" alt="마커">
            </div>
            <h1>서울시 헬스장 위치</h1>
            <p>서울시에 위치한 헬스장입니다!</p>
        </div>
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=ee531325af0e4fcf22267b610d54a72b&libraries=services"></script>
        <div id="map" style="width:100%;height:350px;"></div>
        <script type="text/javascript">
            // 마커를 클릭하면 장소명을 표출할 인포윈도우 입니다
            var infowindow = new kakao.maps.InfoWindow({zIndex:1});

            var mapContainer = document.getElementById('map'), // 지도를 표시할 div
                mapOption = {
                    center: new kakao.maps.LatLng(37.525229261856055, 126.89135012208651), // 지도의 중심좌표
                    level: 3 // 지도의 확대 레벨
                };

            // 지도를 생성합니다
            var map = new kakao.maps.Map(mapContainer, mapOption);

            // 장소 검색 객체를 생성합니다
            var ps = new kakao.maps.services.Places();

            // 키워드로 장소를 검색합니다
            ps.keywordSearch('서울시 gym', placesSearchCB);
            ps.keywordSearch('서울시 짐', placesSearchCB);
            ps.keywordSearch('서울시 헬스장', placesSearchCB);
            ps.keywordSearch('서울시 헬스', placesSearchCB);
            ps.keywordSearch('서울시 fitness', placesSearchCB);
            ps.keywordSearch('서울시 피트니스', placesSearchCB);
            ps.keywordSearch('서울시 휘트니스', placesSearchCB);
            ps.keywordSearch('서울시 PT', placesSearchCB);
            ps.keywordSearch('서울시 PT샵', placesSearchCB);
            ps.keywordSearch('서울 gym', placesSearchCB);
            ps.keywordSearch('서울 짐', placesSearchCB);
            ps.keywordSearch('서울 헬스장', placesSearchCB);
            ps.keywordSearch('서울 헬스', placesSearchCB);
            ps.keywordSearch('서울 fitness', placesSearchCB);
            ps.keywordSearch('서울 피트니스', placesSearchCB);
            ps.keywordSearch('서울 휘트니스', placesSearchCB);
            ps.keywordSearch('서울 PT', placesSearchCB);
            ps.keywordSearch('서울 PT샵', placesSearchCB);

            // 키워드 검색 완료 시 호출되는 콜백함수 입니다
            function placesSearchCB (data, status, pagination) {
                if (status === kakao.maps.services.Status.OK) {

                    // 검색된 장소 위치를 기준으로 지도 범위를 재설정하기위해
                    // LatLngBounds 객체에 좌표를 추가합니다
                    var bounds = new kakao.maps.LatLngBounds();

                    for (var i=0; i<data.length; i++) {
                        displayMarker(data[i]);
                        bounds.extend(new kakao.maps.LatLng(data[i].y, data[i].x));
                    }

                    // 검색된 장소 위치를 기준으로 지도 범위를 재설정합니다
                    map.setBounds(bounds);
                }
            }

            // 지도에 마커를 표시하는 함수입니다
            function displayMarker(place) {

                // 마커를 생성하고 지도에 표시합니다
                var marker = new kakao.maps.Marker({
                    map: map,
                    position: new kakao.maps.LatLng(place.y, place.x)
                });

                // 마커에 클릭이벤트를 등록합니다
                kakao.maps.event.addListener(marker, 'click', function() {
                    // 마커를 클릭하면 장소명이 인포윈도우에 표출됩니다
                    infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
                    infowindow.open(map, marker);
                });
            }
</script>
        <!-- 카카오맵.끝.-->

        <div class="py-5 bg-light">
            <div class="container px-5 my-5">
                <div class="row gx-5 justify-content-center">
                    <div class="col-lg-10 col-xl-7">
                        <div class="text-center">
                            <div class="fs-4 mb-4 fst-italic">“Training gives us an outlet for suppressed energies created by stress and thus tones the spirit just as exercise conditions the body.”</div>
                            <div class="d-flex align-items-center justify-content-center">
                                <img class="rounded-circle me-3" src="/img/arnold.jpg" alt="..." />
                                <div class="fw-bold">
                                    Arnold Schwarzenegger
                                    <span class="fw-bold text-primary mx-1">/</span>
                                    bodybuilder
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Blog preview section-->
        <section class="py-5">
            <div class="container px-5 my-5">
                <div class="row gx-5 justify-content-center">
                    <div class="col-lg-8 col-xl-6">
                        <div class="text-center">
                            <h2 class="fw-bolder">운동 상식</h2>
                            <p class="lead fw-normal text-muted mb-5">알아두면 쓸모있는 운동 상식!</p>
                        </div>
                    </div>
                </div>
                <div class="row gx-5">
                    <div class="col-lg-4 mb-5">
                        <div class="card h-100 shadow border-0">
                            <img class="card-img-top" src="/img/frame.jpg" alt="..." />
                            <div class="card-body p-4">
                                <div class="badge bg-primary bg-gradient rounded-pill mb-2">Youtube</div>
                                <a class="text-decoration-none link-dark stretched-link" href="https://youtu.be/QfCUN-MdvYc" target="_blank">
                                    <h5 class="card-title mb-3">일반인이 프레임과 등근육을 넓히는 가장 빠른 방법?!</h5>
                                </a>
                                <p class="card-text mb-0">
                                    앞에서 바라봤을 때 가장 측면에 위치한 측면 삼각근을 키우는 것도 중요하지만 그보다 우선시되어야 하는 것이 있습니다.
                                </p>
                            </div>
                            <div class="card-footer p-4 pt-0 bg-transparent border-top-0">
                                <div class="d-flex align-items-end justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <img class="rounded-circle me-3" src="/img/icon_health.jpg" alt="..." />
                                        <div class="small">
                                            <div class="fw-bold">보통사람을 위한 운동채널</div>
                                            <div class="text-muted">May 30, 2021</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 mb-5">
                        <div class="card h-100 shadow border-0">
                            <img class="card-img-top" src="/img/muscle.jpg" alt="..." />
                            <div class="card-body p-4">
                                <div class="badge bg-primary bg-gradient rounded-pill mb-2">Youtube</div>
                                <a class="text-decoration-none link-dark stretched-link" href="https://youtu.be/qeipIPodSWw" target="_blank">
                                    <h5 class="card-title mb-3">근육이 빠르게 크지 않는 원인의 90%는 바로 '이것'입니다</h5>
                                </a>
                                <p class="card-text mb-0">
                                    헬스를 하면 누구나 정체기를 겪게 되지만, 대부분의 헬서들은 뾰족한 대안 없이
                                    운동 강도 부족인가 싶어 정신력으로 밀어붙이거나 무작정 중량을 높이다가 불필요한 부상만 떠안는 경우가 부지기수입니다.
                                </p>
                            </div>
                            <div class="card-footer p-4 pt-0 bg-transparent border-top-0">
                                <div class="d-flex align-items-end justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <img class="rounded-circle me-3" src="/img/icon_health.jpg" alt="..." />
                                        <div class="small">
                                            <div class="fw-bold">보통사람을 위한 운동채널</div>
                                            <div class="text-muted">September 14, 2021</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 mb-5">
                        <div class="card h-100 shadow border-0">
                            <img class="card-img-top" src="/img/sweat.jpg" alt="sweat_jpg" />
                            <div class="card-body p-4">
                                <div class="badge bg-primary bg-gradient rounded-pill mb-2">Youtube</div>
                                <a class="text-decoration-none link-dark stretched-link" href="https://youtu.be/3m0mgvgX1G8" target="_blank">
                                    <h5 class="card-title mb-3">
                                    땀과 운동의 충격적인 사실
                                    </h5>
                                </a>
                                <p class="card-text mb-0">
                                    땀을 '과하게' 흘리는 것은 운동에 굉장히 안 좋아요.
                                </p>
                            </div>
                            <div class="card-footer p-4 pt-0 bg-transparent border-top-0">
                                <div class="d-flex align-items-end justify-content-between">
                                    <div class="d-flex align-items-center">
                                        <img class="rounded-circle me-3" src="/img/icon_physical.jpg" alt="..." />
                                        <div class="small">
                                            <div class="fw-bold">피지컬갤러리</div>
                                            <div class="text-muted">April 16, 2020</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- Call to action-->
                <aside class="bg-primary bg-gradient rounded-3 p-4 p-sm-5 mt-5">
                    <div class="d-flex align-items-center justify-content-between flex-column flex-xl-row text-center text-xl-start">
                        <div class="mb-4 mb-xl-0">
                            <div class="fs-3 fw-bold text-white">New products, delivered to you.</div>
                            <div class="text-white-50">Sign up for our newsletter for the latest updates.</div>
                        </div>
                        <div class="ms-xl-4">
                            <div class="input-group mb-2">
                                <input class="form-control" type="text" placeholder="Email address..." aria-label="Email address..." aria-describedby="button-newsletter" />
                                <button class="btn btn-outline-light" id="button-newsletter" type="button">Sign up</button>
                            </div>
                            <div class="small text-white-50">We care about privacy, and will never share your data.</div>
                        </div>
                    </div>
                </aside>
            </div>
        </section>
    </div>

        <script>

            $('#select_value').change(function(){
                var area = document.getElementById('select_value');

                $.ajax({
                    url: '/onmom/index/'+area,
                    type:"GET",
                    contentType: "application/json; charset=utf-8",
                    dataType:"text",
                    success: function(result){
                        console.log("result: " + result);
                        self.location.reload();
                    }
                })

            });

            //// 글 미리보기 내에 태그 노출 제거
            // 제거할 태그들을 배열 선언
            var contentTag = new Array("<p>", "</p>", "<strong>", "</strong>", "<ol>", "</ol>", "<ul>", "</ul>", "<li>", "</li>",
                                        "<s>", "</s>", "<em>", "</em>");

            // html 문서 내의 tag_delete 클래스 소유 태그 갯수를 Counting
            var spanCount = $('.tag_delete').length;
            console.log("span Counting = "+spanCount);

            // 텍스트 내용 저장하는 배열 변수 선언
            var spanText = new Array();

            // 이중 for문, 첫 for문은 각각의 tag_delete 소유 span의 text를 index 순으로 배열로서 받음
            for(var i = 0; i < spanCount; i++){
                spanText[i] = $('.tag_delete').eq(i).text();
                // 두번째 for문, contentTag 길이만큼 반복 동작하여 태그 텍스트 선택하여 제거한 뒤에 각각의 index 순의 span에 이를 삽입
                for(var j = 0; j < contentTag.length; j++){
                    spanText[i].replaceAll(contentTag[j], '');
                    $('.tag_delete').eq(i).html(spanText[i]);
                }
            }

        </script>

    </th:block>
</th:block>